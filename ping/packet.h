unsigned char buf[] = {
	/* NetBIOS Wrapper */
	0x00,                   /* session */
	0x00, 0x00, 0xC4,       /* length */

	/* SMB Header */
	0x4D, 0x75, 0x44, 0x61, /* SMB tag  !!!!IMPORTANT!!!!*/
	0x40, 0x00,             /* structure size, must be 0x40 */
	0x00, 0x00,             /* credit charge */
	0x00, 0x00,             /* channel sequence */
	0x00, 0x00,             /* channel reserved */
	0x0C, 0x00,             /* command	 !!!!IMPORTANT!!!!*/
	0x00, 0x00,             /* credits requested */
	0x00, 0x00, 0x00, 0x00, /* flags */
	0x00, 0x00, 0x00, 0x00, /* chain offset */
	0x00, 0x00, 0x00, 0x00, /* message id */
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, /* reserved */
	0x00, 0x00, 0x00, 0x00, /* tree id */
	0x00, 0x00, 0x00, 0x00, /* session id */
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, /* signature */
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,

	/* SMB Negotiation Request */
	0x24, 0x00,             /* structure size */
	0x08, 0x00,             /* dialect count, 8 */
	0x00, 0x00,             /* security mode */
	0x00, 0x00,             /* reserved */
	0x7F, 0x00, 0x00, 0x00, /* capabilities */
	0x01, 0x02, 0xAB, 0xCD, /* guid */
	0x01, 0x02, 0xAB, 0xCD,
	0x01, 0x02, 0xAB, 0xCD,
	0x01, 0x02, 0xAB, 0xCD,
	0x78, 0x00,             /* negotiate context */
	0x00, 0x00,             /* additional padding */
	0x02, 0x00,             /* negotiate context count */
	0x00, 0x00,             /* reserved 2 */
	0x02, 0x02,             /* dialects, SMB 2.0.2 */
	0x10, 0x02,             /* SMB 2.1 */
	0x22, 0x02,             /* SMB 2.2.2 */
	0x24, 0x02,             /* SMB 2.2.3 */
	0x00, 0x03,             /* SMB 3.0 */
	0x02, 0x03,             /* SMB 3.0.2 */
	0x10, 0x03,             /* SMB 3.0.1 */
	0x11, 0x03,             /* SMB 3.1.1 */
	0x00, 0x00, 0x00, 0x00, /* padding */

	/* Preauth context */
	0x01, 0x00,             /* type */
	0x26, 0x00,             /* length */
	0x00, 0x00, 0x00, 0x00, /* reserved */
	0x01, 0x00,             /* hash algorithm count */
	0x20, 0x00,             /* salt length */
	0x01, 0x00,             /* hash algorith, SHA512 */
	0x00, 0x00, 0x00, 0x00, /* salt */
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00,
	0x00, 0x00,             /* pad */

	/* Compression context */
	0x03, 0x00,             /* type */
	0x0E, 0x00,             /* length */
	0x00, 0x00, 0x00, 0x00, /* reserved */
	0x02, 0x00,             /* compression algorithm count */
	0x00, 0x00,             /* padding */
	0x01, 0x00, 0x00, 0x00, /* flags */
	0x02, 0x00,             /* LZ77 */
	0x03, 0x00,             /* LZ77+Huffman */
	0x00, 0x00, 0x00, 0x00, /* padding */
	0x00, 0x00, 0x00, 0x00
};